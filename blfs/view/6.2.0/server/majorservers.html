<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      Chapter&nbsp;21.&nbsp;Major Servers
    </title>
    <link rel="stylesheet" href="../stylesheets/blfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.69.1" />
    <link rel="stylesheet" href="../stylesheets/blfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body id="blfs" class="6.2.0">
    <div class="navheader">
      <div class="headertitles">
        <h4>
          Beyond Linux From Scratch - Version 6.2.0
        </h4>
        <h3>
          Part&nbsp;VI.&nbsp;Servers
        </h3>
      </div>
      <ul class="headerlinks">
        <li class="prev">
          <a accesskey="p" href="server.html" title="Servers">Prev</a>
          <p>
            Servers
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="bind.html" title="BIND-9.3.3">Next</a>
          <p>
            BIND-9.3.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="server.html" title=
          "Part&nbsp;VI.&nbsp;Servers">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>
        </li>
      </ul>
    </div>
    <div class="chapter" lang="en" xml:lang="en">
      <div class="titlepage">
        <a id="server-major" name="server-major"></a>
        <h1 class="chapter">
          Major Servers
        </h1>
      </div>
      <p>
        Major servers are the programs that provide content or services to
        users or other programs.
      </p>
      <div class="sect1" lang="en" xml:lang="en">
        <div class="titlepage">
          <a id="apache" name="apache"></a>
          <h1 class="sect1">
            Apache-2.2.2
          </h1>
        </div>
        <div class="package" lang="en" xml:lang="en">
          <div class="titlepage">
            <h2 class="sect2">
              Introduction to Apache
            </h2>
          </div>
          <p>
            The <span class="application">Apache</span> package contains an
            open-source HTTP server. It is useful for creating local intranet
            web sites or running huge web serving operations.
          </p>
          <h3>
            <a id="id2832616" name="id2832616"></a>Package Information
          </h3>
          <div class="itemizedlist">
            <ul compact="compact">
              <li>
                <p>
                  Download (HTTP): <a href=
                  "http://archive.apache.org/dist/httpd//httpd-2.2.2.tar.bz2">
                  <span class=
                  "url">http://archive.apache.org/dist/httpd//httpd-2.2.2.tar.bz2</span></a>
                </p>
              </li>
              <li>
                <p>
                  Download (FTP): <a href=
                  "ftp://apache.mirrors.pair.com/httpd/httpd-2.2.2.tar.bz2"><span class="url">
                  ftp://apache.mirrors.pair.com/httpd/httpd-2.2.2.tar.bz2</span></a>
                </p>
              </li>
              <li>
                <p>
                  Download MD5 sum: 9c759a9744436de6a6aa2ddbc49d6e81
                </p>
              </li>
              <li>
                <p>
                  Download size: 4.8 MB
                </p>
              </li>
              <li>
                <p>
                  Estimated disk space required: 91.5 MB
                </p>
              </li>
              <li>
                <p>
                  Estimated build time: 2.0 SBU
                </p>
              </li>
            </ul>
          </div>
          <h3>
            <a id="id2832542" name="id2832542"></a>Additional Downloads
          </h3>
          <div class="itemizedlist">
            <ul compact="compact">
              <li>
                <p>
                  Required patch: <a href=
                  "http://www.linuxfromscratch.org/patches/blfs/6.2.0/httpd-2.2.2-config-1.patch">
                  <span class=
                  "url">http://www.linuxfromscratch.org/patches/blfs/6.2.0/httpd-2.2.2-config-1.patch</span></a>
                </p>
              </li>
            </ul>
          </div>
          <h3>
            <a id="id2832433" name="id2832433"></a>Apache Dependencies
          </h3>
          <h4>
            <a id="id2832508" name="id2832508"></a>Optional
          </h4>
          <p class="optional">
            <a href="../general/gdbm.html">GDBM-1.8.3</a>, <a href=
            "../postlfs/security.html#openssl">OpenSSL-0.9.8d</a>, <a href=
            "openldap.html">OpenLDAP-2.3.27</a>, <a href=
            "postgresql.html">PostgreSQL-8.1.3</a>, <a href=
            "http://sqlite.org/"><span class="url">SQLite</span></a>,
            <a href="../general/genlib.html#pcre">PCRE-6.7</a>, <a href=
            "../general/pkgconfig.html">pkg-config-0.20</a>, <a href=
            "../general/expat.html">expat-2.0.0</a>, and <a href=
            "http://www.distcache.org/"><span class=
            "url">distcache</span></a>
          </p>
          <p class="usernotes">
            User Notes: <a href=
            "http://wiki.linuxfromscratch.org/blfs/wiki/apache"><span class=
            "url">http://wiki.linuxfromscratch.org/blfs/wiki/apache</span></a>
          </p>
        </div>
        <div class="installation" lang="en" xml:lang="en">
          <div class="titlepage">
            <h2 class="sect2">
              Installation of Apache
            </h2>
          </div>
          <p>
            For security reasons, running the server as an unprivileged user
            and group is strongly encouraged. Create the following group and
            user using the following commands (as <tt class=
            "systemitem">root</tt>):
          </p>
          <pre class="root"><kbd class=
          "command">groupadd -g 25 apache &amp;&amp;
useradd -c "Apache Server" -d /dev/null -g apache \
        -s /bin/false -u 25 apache</kbd></pre>
          <div class="note">
            <div class="admonhead">
              <img alt="[Note]" src="../images/note.png" />
              <h3 class="admontitle">
                Note
              </h3>
            </div>
            <div class="admonbody">
              <p>
                The above command directs the <span class=
                "application">Apache</span> user's home directory to
                <tt class="filename">/dev/null</tt>. This may not work for
                some add-ons such as <a href=
                "http://www.viewvc.org/"><span class="url"><span class=
                "application">ViewVC</span></span></a>, a browser interface
                for CVS and Subversion version control repositories. See the
                User Notes for details for specific applications.
              </p>
            </div>
          </div>
          <p>
            The following patch modifies the layout of destination
            directories and among them, the build directory at <tt class=
            "filename">/usr/lib/apache/build</tt>. This will allow the
            modules added to <span class="application">Apache</span> to be
            configured without errors. Apply the patch:
          </p>
          <pre class="userinput"><kbd class=
          "command">patch -Np1 -i ../httpd-2.2.2-config-1.patch</kbd></pre>
          <div class="note">
            <div class="admonhead">
              <img alt="[Note]" src="../images/note.png" />
              <h3 class="admontitle">
                Note
              </h3>
            </div>
            <div class="admonbody">
              <p>
                You may wish to review the output from <span><strong class=
                "command">./configure --help</strong></span> and include
                whatever parameters are necessary to the <span><strong class=
                "command">configure</strong></span> command below to build
                the modules required for your installation. There are as many
                as 62 additional parameters you can add to the
                <span><strong class="command">configure</strong></span>
                command to build additional modules. Some of the extra
                parameters which aren't described or mentioned in the
                <em class="parameter"><tt>--help</tt></em> information are
                listed in the &ldquo;<span class="quote">Command
                Explanations</span>&rdquo; section below.
              </p>
            </div>
          </div>
          <p>
            Build and install <span class="application">Apache</span> by
            running the following commands:
          </p>
          <pre class="userinput"><kbd class=
          "command">./configure --enable-layout=FHS --enable-mods-shared=all &amp;&amp;
make</kbd></pre>
          <p>
            This package does not come with a test suite.
          </p>
          <p>
            Now, as the <tt class="systemitem">root</tt> user:
          </p>
          <pre class="root"><kbd class="command">make install &amp;&amp;
chown -v root:root /usr/lib/apache/httpd.exp \
    /usr/sbin/{apxs,apachectl,dbmmanage,envvars{,-std}} \
    /usr/share/man/man1/{dbmmanage,ht{dbm,digest,passwd}}.1 \
    /usr/share/man/man8/{ab,apachectl,apxs,htcacheclean,httpd}.8 \
    /usr/share/man/man8/{logresolve,rotatelogs,suexec}.8 &amp;&amp;
chown -v -R apache:apache /srv/www</kbd></pre>
        </div>
        <div class="commands" lang="en" xml:lang="en">
          <div class="titlepage">
            <h2 class="sect2">
              Command Explanations
            </h2>
          </div>
          <p>
            <tt class="option">--with-expat=/usr</tt>: Uses the system
            installed <span class="application">expat</span>. <span class=
            "strong"><strong>If you have installed <span class=
            "application">expat</span> and do not use this switch, the
            <span class="application">Apache</span> installation may
            overwrite some files from the <span class=
            "application">expat</span> installation.</strong></span>
          </p>
          <p>
            <em class="parameter"><tt>--enable-mods-shared=all</tt></em>: The
            modules should be compiled and used as Dynamic Shared Objects
            (DSOs) so they can be included and excluded from the server using
            the run-time configuration directives.
          </p>
          <p>
            <tt class="option">--enable-ssl</tt>: Use this parameter to
            create the <tt class="filename">mod_ssl</tt> module and enable
            SSL support. This parameter is mentioned as one of many
            parameters which can be passed to the <span><strong class=
            "command">configure</strong></span> command to create additional
            DSO modules.
          </p>
          <p>
            <tt class="option">--with-pcre</tt>: Add this parameter to use
            the system installed version of the <span class=
            "application">PCRE</span> library.
          </p>
          <p>
            <tt class="option">--with-z</tt>: Add this parameter to use the
            system installed version of the <span class=
            "application">Zlib</span> library.
          </p>
          <p>
            <tt class="option">--with-ldap</tt>: This parameter is required
            if you passed the <tt class="option">--enable-authnz-ldap</tt> or
            <tt class="option">--enable-ldap</tt> options to
            <span><strong class="command">configure</strong></span> and
            enabled the <span class="application">OpenLDAP</span> modules.
          </p>
          <p>
            <span><strong class="command">chown root:root
            ...</strong></span>: This command changes the ownership of some
            installed files, the result of building the package as a user
            other than <tt class="systemitem">root</tt>.
          </p>
          <p>
            <span><strong class="command">chown -R apache:apache
            /srv/www</strong></span>: By default, the installation process
            installs files (documentation, error messages, default icons,
            etc.) with the ownership of the user that extracted the files
            from the tar file. If you want to change the ownership to another
            user, you should do so at this point. The only requirement is
            that the document directories need to be accessible by the
            <span><strong class="command">httpd</strong></span> process with
            (r-x) permissions and files need to be readable (r--) by the
            <tt class="systemitem">apache</tt> user.
          </p>
        </div>
        <div class="configuration" lang="en" xml:lang="en">
          <div class="titlepage">
            <h2 class="sect2">
              Configuring Apache
            </h2>
          </div>
          <div class="sect3" lang="en" xml:lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title">
                    <a id="apache-config" name="apache-config"></a>Config
                    Files
                  </h4>
                </div>
              </div>
            </div>
            <p>
              <tt class="filename">/etc/apache/*</tt>
            </p>
          </div>
          <div class="sect3" lang="en" xml:lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title">
                    <a id="id2840775" name="id2840775"></a>Configuration
                    Information
                  </h4>
                </div>
              </div>
            </div>
            <p>
              The main configuration file is named <tt class=
              "filename">/etc/apache/httpd.conf</tt>. Modify it so that the
              HTTP server runs as the dedicated user and group:
            </p>
            <pre class="root"><kbd class=
            "command">sed -i -e "s/User daemon/User apache/" \
       -e "s/Group daemon/Group apache/" \
    /etc/apache/httpd.conf</kbd></pre>
            <p>
              See <a href=
              "http://httpd.apache.org/docs-2.2/configuring.html"><span class="url">
              http://httpd.apache.org/docs-2.2/configuring.html</span></a>
              for detailed instructions on customizing your <span class=
              "application">Apache</span> HTTP server configuration file.
            </p>
            <p>
              There's a problem with the ISAPI DSO module caused from
              compiling with <span class="application">GCC</span>-4.0.3. If
              you included the parameter to build the module, comment out the
              module's load command in the configuration file with the
              following command:
            </p>
            <pre class="root"><kbd class=
            "command">sed -i "s/^LoadModule isapi_module/# &amp;/" \
    /etc/apache/httpd.conf</kbd></pre>
          </div>
          <div class="sect3" lang="en" xml:lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title">
                    <a id="apache-init" name="apache-init"></a>Boot Script
                  </h4>
                </div>
              </div>
            </div>
            <p>
              If you want the <span class="application">Apache</span> server
              to start automatically when the system is booted, install the
              <tt class="filename">/etc/rc.d/init.d/apache</tt> init script
              included in the <a href=
              "../introduction/bootscripts.html">blfs-bootscripts-20060910</a>
              package.
            </p>
            <pre class="root"><kbd class=
            "command">make install-apache</kbd></pre>
          </div>
        </div>
        <div class="content" lang="en" xml:lang="en">
          <div class="titlepage">
            <h2 class="sect2">
              Contents
            </h2>
          </div>
          <div class="segmentedlist">
            <div class="seglistitem">
              <div class="seg">
                <strong><span class="segtitle">Installed
                Programs:</span></strong> <span class="seg">ab, apachectl,
                apr-config, apu-config, apxs, checkgid, dbmmanage, htdbm,
                htdigest, htpasswd, httpd, instdso.sh, logresolve, and
                rotatelogs</span>
              </div>
              <div class="seg">
                <strong><span class="segtitle">Installed
                Libraries:</span></strong> <span class="seg">libapr-1.{so,a},
                libaprutil-1.{so,a}, and /usr/lib/apache/*.so</span>
              </div>
              <div class="seg">
                <strong><span class="segtitle">Installed
                Directories:</span></strong> <span class="seg">/etc/apache,
                /srv/www, /usr/include/apache, /usr/lib/apache, and
                /var/log/apache</span>
              </div>
            </div>
          </div>
          <div class="variablelist">
            <h3>
              <a id="id2842867" name="id2842867"></a>Short Descriptions
            </h3>
            <table border="0">
              <col align="left" valign="top" />
              <tbody>
                <tr>
                  <td>
                    <a id="ab" name="ab"></a><span class=
                    "term"><span><strong class=
                    "command">ab</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a tool for benchmarking your <span class=
                      "application">Apache</span> HTTP server.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="apachectl" name="apachectl"></a><span class=
                    "term"><span><strong class=
                    "command">apachectl</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a front end to the <span class=
                      "application">Apache</span> HTTP server which is
                      designed to help the administrator control the
                      functioning of the <span class=
                      "application">Apache</span> httpd daemon.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="apxs" name="apxs"></a><span class=
                    "term"><span><strong class=
                    "command">apxs</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a tool for building and installing extension modules
                      for the <span class="application">Apache</span> HTTP
                      server.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="dbmanage" name="dbmanage"></a><span class=
                    "term"><span><strong class=
                    "command">dbmanage</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is used to create and update the DBM format files used
                      to store usernames and passwords for basic
                      authentication of HTTP users.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="htdigest" name="htdigest"></a><span class=
                    "term"><span><strong class=
                    "command">htdigest</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is used to create and update the flat-files used to
                      store usernames, realms and passwords for digest
                      authentication of HTTP users.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="htpasswd" name="htpasswd"></a><span class=
                    "term"><span><strong class=
                    "command">htpasswd</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is used to create and update the flat-files used to
                      store usernames and passwords for basic authentication
                      of HTTP users.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="httpd" name="httpd"></a><span class=
                    "term"><span><strong class=
                    "command">httpd</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is the <span class="application">Apache</span> HTTP
                      server program.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="instdso.sh" name="instdso.sh"></a><span class=
                    "term"><span><strong class=
                    "command">instdso.sh</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a script which installs <span class=
                      "application">Apache</span> DSO modules.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="logresolve" name="logresolve"></a><span class=
                    "term"><span><strong class=
                    "command">logresolve</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a post-processing program to resolve IP-addresses in
                      <span class="application">Apache</span>'s access log
                      files.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <a id="rotatelogs" name="rotatelogs"></a><span class=
                    "term"><span><strong class=
                    "command">rotatelogs</strong></span></span>
                  </td>
                  <td>
                    <p>
                      is a simple program for use in conjunction with
                      <span class="application">Apache</span>'s piped log
                      file feature.
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <p class="updated">
        Last updated on 2007-01-27 11:36:13 -0600
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="server.html" title="Servers">Prev</a>
          <p>
            Servers
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="bind.html" title="BIND-9.3.3">Next</a>
          <p>
            BIND-9.3.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="server.html" title=
          "Part&nbsp;VI.&nbsp;Servers">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>.
        </li>
      </ul>
    </div>
  </body>
</html>
