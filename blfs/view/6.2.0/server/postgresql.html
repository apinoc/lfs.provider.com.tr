<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      PostgreSQL-8.1.3
    </title>
    <link rel="stylesheet" href="../stylesheets/blfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.69.1" />
    <link rel="stylesheet" href="../stylesheets/blfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body id="blfs" class="6.2.0">
    <div class="navheader">
      <div class="headertitles">
        <h4>
          Beyond Linux From Scratch - Version 6.2.0
        </h4>
        <h3>
          Chapter&nbsp;23.&nbsp;Databases
        </h3>
      </div>
      <ul class="headerlinks">
        <li class="prev">
          <a accesskey="p" href="mysql.html" title="MySQL-5.0.21">Prev</a>
          <p>
            MySQL-5.0.21
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="other.html" title=
          "Other Server Software">Next</a>
          <p>
            Other Server Software
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="databases.html" title=
          "Chapter&nbsp;23.&nbsp;Databases">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="titlepage">
        <a id="postgresql" name="postgresql"></a>
        <h1 class="sect1">
          PostgreSQL-8.1.3
        </h1>
      </div>
      <div class="package" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Introduction to PostgreSQL
          </h2>
        </div>
        <p>
          <span class="application">PostgreSQL</span> is an advanced
          object-relational database management system (ORDBMS), derived from
          the Berkeley Postgres database management system.
        </p>
        <h3>
          <a id="id2671818" name="id2671818"></a>Package Information
        </h3>
        <div class="itemizedlist">
          <ul compact="compact">
            <li>
              <p>
                Download (HTTP): <a href=
                "http://anduin.linuxfromscratch.org/sources/BLFS/6.2.0/p/postgresql-8.1.3.tar.bz2">
                <span class=
                "url">http://anduin.linuxfromscratch.org/sources/BLFS/6.2.0/p/postgresql-8.1.3.tar.bz2</span></a>
              </p>
            </li>
            <li>
              <p>
                Download (FTP): <a href=
                "ftp://ftp-archives.postgresql.org/pub/source/v8.1.3/postgresql-8.1.3.tar.bz2">
                <span class=
                "url">ftp://ftp-archives.postgresql.org/pub/source/v8.1.3/postgresql-8.1.3.tar.bz2</span></a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: bb510edbb533962c0692e211b3bd8cfa
              </p>
            </li>
            <li>
              <p>
                Download size: 11.5 MB
              </p>
            </li>
            <li>
              <p>
                Estimated disk space required: 153 MB (additional 100 MB to
                run the testsuite)
              </p>
            </li>
            <li>
              <p>
                Estimated build time: 1.7 SBU
              </p>
            </li>
          </ul>
        </div>
        <h3>
          <a id="id2561482" name="id2561482"></a>PostgreSQL Dependencies
        </h3>
        <h4>
          <a id="id2803510" name="id2803510"></a>Optional
        </h4>
        <p class="optional">
          <a href="../general/python.html">Python-2.4.4</a>, <a href=
          "../general/tcl.html">Tcl-8.4.13</a>, <a href=
          "../postlfs/security.html#openssl">OpenSSL-0.9.8d</a>, <a href=
          "../postlfs/linux-pam.html">Linux-PAM-0.99.4.0</a>, <a href=
          "http://www.pdc.kth.se/kth-krb/"><span class="url">krb4</span></a>,
          <a href="../postlfs/mitkrb.html">MIT Kerberos V5-1.6</a> or
          <a href="../postlfs/heimdal.html">Heimdal-0.7.2</a>, and <a href=
          "http://developer.apple.com/networking/bonjour/"><span class=
          "url">Bonjour</span></a>
        </p>
        <h4>
          <a id="id2592586" name="id2592586"></a>Optional (To Regenerate
          Documentation)
        </h4>
        <p class="optional">
          <a href="../pst/sgml-dtd.html">DocBook SGML DTD-4.4</a>, <a href=
          "../pst/docbook-dsssl.html">DocBook DSSSL Stylesheets-1.79</a>,
          <a href="../pst/openjade.html">OpenJade-1.3.2</a>, and <a href=
          "../general/perl-modules.html#perl-sgmlspm">SGMLSpm-1.03ii</a>
        </p>
        <p class="usernotes">
          User Notes: <a href=
          "http://wiki.linuxfromscratch.org/blfs/wiki/postgresql"><span class="url">
          http://wiki.linuxfromscratch.org/blfs/wiki/postgresql</span></a>
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Installation of PostgreSQL
          </h2>
        </div>
        <p>
          Install <span class="application">PostgreSQL</span> with the
          following commands:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -i "s|dsssl-stylesheets|&amp; \\\\\n        sgml/docbook/&amp;-1.79|" \
    configure &amp;&amp;
./configure --prefix=/usr --enable-thread-safety &amp;&amp;
make</kbd></pre>
        <p>
          To test the results, issue: <span><strong class="command">make
          check</strong></span>.
        </p>
        <p>
          Now, as the <tt class="systemitem">root</tt> user:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
chown -v root:root /usr/share/doc/postgresql/html/* &amp;&amp;
install -v -m755 -d /usr/share/doc/postgresql/{FAQ/html,TODO.detail} &amp;&amp;
install -v -m644 doc/TODO /usr/share/doc/postgresql &amp;&amp;
install -v -m644 doc/FAQ* /usr/share/doc/postgresql/FAQ &amp;&amp;
install -v -m644 doc/src/FAQ/* /usr/share/doc/postgresql/FAQ/html &amp;&amp;
install -v -m644 doc/TODO.detail/* \
    /usr/share/doc/postgresql/TODO.detail</kbd></pre>
        <div class="note">
          <div class="admonhead">
            <img alt="[Note]" src="../images/note.png" />
            <h3 class="admontitle">
              Note
            </h3>
          </div>
          <div class="admonbody">
            <p>
              If you are upgrading an existing system and are going to
              install the new files over the old ones, then you should back
              up your data, shut down the old server and follow the
              instructions in <a href=
              "http://www.postgresql.org/docs/8.1/static/install-upgrading.html">
              <span class="url">the official <span class=
              "application">PostgreSQL</span> documentation</span></a>.
            </p>
          </div>
        </div>
        <p>
          Initialize a database cluster with the following commands issued by
          the <tt class="systemitem">root</tt> user:
        </p>
        <pre class="root"><kbd class=
        "command">install -v -m755 -d /srv/pgsql/data &amp;&amp;
groupadd -g 41 postgres &amp;&amp;
useradd -c "PostgreSQL Server" -g postgres -d /srv/pgsql/data \
        -u 41 postgres &amp;&amp;
chown -v postgres /srv/pgsql/data &amp;&amp;
su - postgres -c '/usr/bin/initdb -D /srv/pgsql/data'</kbd></pre>
        <p>
          As the <tt class="systemitem">root</tt> user, start the database
          server with the following command:
        </p>
        <pre class="root"><kbd class=
        "command">su - postgres -c '/usr/bin/postmaster -D /srv/pgsql/data &gt; \
    /srv/pgsql/data/logfile 2&gt;&amp;1 &amp;'</kbd></pre>
        <p>
          Still as user <tt class="systemitem">root</tt>, create a database
          and verify the installation:
        </p>
        <pre class="root"><kbd class=
        "command">su - postgres -c '/usr/bin/createdb test' &amp;&amp;
echo "create table t1 ( name varchar(20), state_province varchar(20) );" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Billy', 'NewYork');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Evanidus', 'Quebec');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Jesse', 'Ontario');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "select * from t1;" | (su - postgres -c '/usr/bin/psql test')</kbd></pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Command Explanations
          </h2>
        </div>
        <p>
          <span><strong class="command">sed -i
          "s|dsssl-stylesheets|..."</strong></span>: This command puts an
          extra line in the <span><strong class=
          "command">configure</strong></span> script so that the BLFS
          installed version of the DSSSL stylesheets are discovered.
        </p>
        <p>
          <em class="parameter"><tt>--enable-thread-safety</tt></em>: This
          switch makes the client libraries thread-safe by allowing
          concurrent threads in <tt class="filename">libpq</tt> and ECPG
          programs to safely control their private connection handles.
        </p>
        <p>
          <span><strong class="command">chown -R root:root
          /usr/share/doc/postgresql/html/*</strong></span>: This command
          corrects the improper ownership of documentation files.
        </p>
        <p>
          <span><strong class="command">groupadd ...</strong></span>;
          <span><strong class="command">useradd ...</strong></span>: These
          commands add an unprivileged user and group to run the database
          server.
        </p>
        <p>
          <span><strong class="command">createdb test; create table t1;
          insert into t1 values...; select * from t1</strong></span>: Create
          a database, add a table to it, insert some rows into the table and
          select them to verify that the installation is working properly.
        </p>
      </div>
      <div class="configuration" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Configuring PostgreSQL
          </h2>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title">
                  <a id="postgresql-config" name=
                  "postgresql-config"></a>Config Files
                </h4>
              </div>
            </div>
          </div>
          <p>
            <tt class="filename">$PGDATA/pg_ident.con</tt>, <tt class=
            "filename">$PGDATA/pg_hba.conf</tt> and <tt class=
            "filename">$PGDATA/postgresql.conf</tt>
          </p>
          <p>
            The <tt class="envar">PGDATA</tt> environment variable is used to
            distinguish database clusters from one another by setting it to
            the value of the directory which contains the cluster desired.
            The three configuration files exist in every <tt class=
            "filename">PGDATA/</tt> directory. Details on the format of the
            files and the options that can be set in each can be found in
            <a href=
            "file:///usr/share/doc/postgresql/html/index.html"><span class=
            "url">file:///usr/share/doc/postgresql/html/index.html</span></a>.
          </p>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title">
                  <a id="postgresql-init" name="postgresql-init"></a>Boot
                  Script
                </h4>
              </div>
            </div>
          </div>
          <p>
            Install the <tt class="filename">/etc/rc.d/init.d/postgresql</tt>
            init script included in the <a href=
            "../introduction/bootscripts.html">blfs-bootscripts-20060910</a>
            package.
          </p>
          <pre class="root"><kbd class=
          "command">make install-postgresql</kbd></pre>
        </div>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Contents
          </h2>
        </div>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong><span class="segtitle">Installed
              Programs:</span></strong> <span class="seg">clusterdb,
              createdb, createlang, createuser, dropdb, droplang, dropuser,
              ecpg, initdb, ipcclean, pg_config, pg_controldata, pg_ctl,
              pg_dump, pg_dumpall, pg_resetxlog, pg_restore, pltcl_delmod,
              pltcl_listmod, pltcl_loadmod, postgres, postmaster, psql, and
              vacuumdb</span>
            </div>
            <div class="seg">
              <strong><span class="segtitle">Installed
              Libraries:</span></strong> <span class="seg">libecpg.{so,a},
              libecpg_compat.{so,a}, libpgport.a, libpgtypes.{so,a},
              libpq.{so,a}, and various charset modules.</span>
            </div>
            <div class="seg">
              <strong><span class="segtitle">Installed
              Directories:</span></strong> <span class="seg">/srv/pgsql,
              /usr/include/libpq, /usr/include/postgresql,
              /usr/lib/postgresql, /usr/share/doc/postgresql, and
              /usr/share/postgresql</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            <a id="id2574493" name="id2574493"></a>Short Descriptions
          </h3>
          <table border="0">
            <col align="left" valign="top" />
            <tbody>
              <tr>
                <td>
                  <a id="clusterdb" name="clusterdb"></a><span class=
                  "term"><span><strong class=
                  "command">clusterdb</strong></span></span>
                </td>
                <td>
                  <p>
                    is a utility for reclustering tables in a <span class=
                    "application">PostgreSQL</span> database.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="createdb" name="createdb"></a><span class=
                  "term"><span><strong class=
                  "command">createdb</strong></span></span>
                </td>
                <td>
                  <p>
                    creates a new <span class="application">PostgreSQL</span>
                    database.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="createlang" name="createlang"></a><span class=
                  "term"><span><strong class=
                  "command">createlang</strong></span></span>
                </td>
                <td>
                  <p>
                    defines a new <span class="application">PostgreSQL</span>
                    procedural language.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="createuser" name="createuser"></a><span class=
                  "term"><span><strong class=
                  "command">createuser</strong></span></span>
                </td>
                <td>
                  <p>
                    defines a new <span class="application">PostgreSQL</span>
                    user account.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dropdb" name="dropdb"></a><span class=
                  "term"><span><strong class=
                  "command">dropdb</strong></span></span>
                </td>
                <td>
                  <p>
                    removes a <span class="application">PostgreSQL</span>
                    database.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="droplang" name="droplang"></a><span class=
                  "term"><span><strong class=
                  "command">droplang</strong></span></span>
                </td>
                <td>
                  <p>
                    removes a <span class="application">PostgreSQL</span>
                    procedural language.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dropuser" name="dropuser"></a><span class=
                  "term"><span><strong class=
                  "command">dropuser</strong></span></span>
                </td>
                <td>
                  <p>
                    removes a <span class="application">PostgreSQL</span>
                    user account.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="ecpg" name="ecpg"></a><span class=
                  "term"><span><strong class=
                  "command">ecpg</strong></span></span>
                </td>
                <td>
                  <p>
                    is the embedded SQL preprocessor.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="initdb" name="initdb"></a><span class=
                  "term"><span><strong class=
                  "command">initdb</strong></span></span>
                </td>
                <td>
                  <p>
                    creates a new database cluster.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="ipcclean" name="ipcclean"></a><span class=
                  "term"><span><strong class=
                  "command">ipcclean</strong></span></span>
                </td>
                <td>
                  <p>
                    removes shared memory and semaphores left over by an
                    aborted database server.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_config" name="pg_config"></a><span class=
                  "term"><span><strong class=
                  "command">pg_config</strong></span></span>
                </td>
                <td>
                  <p>
                    retrieves <span class="application">PostgreSQL</span>
                    version information.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_controldata" name=
                  "pg_controldata"></a><span class=
                  "term"><span><strong class="command">pg_controldata</strong></span></span>
                </td>
                <td>
                  <p>
                    returns information initialized during
                    <span><strong class="command">initdb</strong></span>,
                    such as the catalog version and server locale.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_ctl" name="pg_ctl"></a><span class=
                  "term"><span><strong class=
                  "command">pg_ctl</strong></span></span>
                </td>
                <td>
                  <p>
                    controls stopping and starting the database server.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_dump" name="pg_dump"></a><span class=
                  "term"><span><strong class=
                  "command">pg_dump</strong></span></span>
                </td>
                <td>
                  <p>
                    dumps database data and metadata into scripts which are
                    used to recreate the database.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_dumpall" name="pg_dumpall"></a><span class=
                  "term"><span><strong class=
                  "command">pg_dumpall</strong></span></span>
                </td>
                <td>
                  <p>
                    recursively calls <span><strong class=
                    "command">pg_dump</strong></span> for each database in a
                    cluster.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_resetxlog" name="pg_resetxlog"></a><span class=
                  "term"><span><strong class=
                  "command">pg_resetxlog</strong></span></span>
                </td>
                <td>
                  <p>
                    clears the write-ahead log and optionally resets some
                    fields in the <tt class="filename">pg_control</tt> file.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pg_restore" name="pg_restore"></a><span class=
                  "term"><span><strong class=
                  "command">pg_restore</strong></span></span>
                </td>
                <td>
                  <p>
                    creates databases from dump files created by
                    <span><strong class="command">pg_dump</strong></span>.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pltcl_delmod" name="pltcl_delmod"></a><span class=
                  "term"><span><strong class=
                  "command">pltcl_delmod</strong></span></span>
                </td>
                <td>
                  <p>
                    is a support script used to delete a module from a
                    PL/<span class="application">Tcl</span> table. The
                    command requires the <a href=
                    "http://gborg.postgresql.org/project/pgtcl/"><span class=
                    "url">Pgtcl</span></a> package to be installed also.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pltcl_listmod" name="pltcl_listmod"></a><span class=
                  "term"><span><strong class=
                  "command">pltcl_listmod</strong></span></span>
                </td>
                <td>
                  <p>
                    is a support script used to list the modules in a
                    PL/<span class="application">Tcl</span> table. The
                    command requires the <a href=
                    "http://gborg.postgresql.org/project/pgtcl/"><span class=
                    "url">Pgtcl</span></a> package to be installed also.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="pltcl_loadmod" name="pltcl_loadmod"></a><span class=
                  "term"><span><strong class=
                  "command">pltcl_loadmod</strong></span></span>
                </td>
                <td>
                  <p>
                    is a support script used to load a module into a
                    PL/<span class="application">Tcl</span> table. The
                    command requires the <a href=
                    "http://gborg.postgresql.org/project/pgtcl/"><span class=
                    "url">Pgtcl</span></a> package to be installed also.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="postgres" name="postgres"></a><span class=
                  "term"><span><strong class=
                  "command">postgres</strong></span></span>
                </td>
                <td>
                  <p>
                    is a single user database server, generally used for
                    debugging.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="postmaster" name="postmaster"></a><span class=
                  "term"><span><strong class=
                  "command">postmaster</strong></span></span>
                </td>
                <td>
                  <p>
                    is a multi-user database daemon.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="psql" name="psql"></a><span class=
                  "term"><span><strong class=
                  "command">psql</strong></span></span>
                </td>
                <td>
                  <p>
                    is a console based database shell.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="vacuumdb" name="vacuumdb"></a><span class=
                  "term"><span><strong class=
                  "command">vacuumdb</strong></span></span>
                </td>
                <td>
                  <p>
                    compacts databases and generates statistics for the query
                    analyzer.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on 2007-01-28 10:12:24 -0600
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="mysql.html" title="MySQL-5.0.21">Prev</a>
          <p>
            MySQL-5.0.21
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="other.html" title=
          "Other Server Software">Next</a>
          <p>
            Other Server Software
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="databases.html" title=
          "Chapter&nbsp;23.&nbsp;Databases">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>.
        </li>
      </ul>
    </div>
  </body>
</html>
