<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      D-BUS-0.62
    </title>
    <link rel="stylesheet" href="../stylesheets/blfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.69.1" />
    <link rel="stylesheet" href="../stylesheets/blfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body id="blfs" class="6.2.0">
    <div class="navheader">
      <div class="headertitles">
        <h4>
          Beyond Linux From Scratch - Version 6.2.0
        </h4>
        <h3>
          Chapter&nbsp;11.&nbsp;System Utilities
        </h3>
      </div>
      <ul class="headerlinks">
        <li class="prev">
          <a accesskey="p" href="apache-ant.html" title=
          "Apache Ant-1.6.5">Prev</a>
          <p>
            Apache Ant-1.6.5
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="hal.html" title="HAL-0.5.7.1">Next</a>
          <p>
            HAL-0.5.7.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapter&nbsp;11.&nbsp;System Utilities">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="titlepage">
        <a id="dbus" name="dbus"></a>
        <h1 class="sect1">
          D-BUS-0.62
        </h1>
      </div>
      <div class="package" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Introduction to D-BUS
          </h2>
        </div>
        <p>
          <span class="application">D-BUS</span> is a message bus system, a
          simple way for applications to talk to one another. <span class=
          "application">D-BUS</span> supplies both a system daemon (for
          events such as &ldquo;<span class="quote">new hardware device
          added</span>&rdquo; or &ldquo;<span class="quote">printer queue
          changed</span>&rdquo;) and a per-user-login-session daemon (for
          general IPC needs among user applications). Also, the message bus
          is built on top of a general one-to-one message passing framework,
          which can be used by any two applications to communicate directly
          (without going through the message bus daemon).
        </p>
        <h3>
          <a id="id2741545" name="id2741545"></a>Package Information
        </h3>
        <div class="itemizedlist">
          <ul compact="compact">
            <li>
              <p>
                Download (HTTP): <a href=
                "http://dbus.freedesktop.org/releases/dbus-0.62.tar.gz"><span class="url">
                http://dbus.freedesktop.org/releases/dbus-0.62.tar.gz</span></a>
              </p>
            </li>
            <li>
              <p>
                Download (FTP): <a href=
                "ftp://ftp.fu-berlin.de/unix/linux/mirrors/gentoo/distfiles/dbus-0.62.tar.gz">
                <span class=
                "url">ftp://ftp.fu-berlin.de/unix/linux/mirrors/gentoo/distfiles/dbus-0.62.tar.gz</span></a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: ba7692f63d0e9f1ef06703dff56cb650b
              </p>
            </li>
            <li>
              <p>
                Download size: 1.7 MB
              </p>
            </li>
            <li>
              <p>
                Estimated disk space required: 69.4 MB (includes building and
                installing all docs)
              </p>
            </li>
            <li>
              <p>
                Estimated build time: 1.0 SBU
              </p>
            </li>
          </ul>
        </div>
        <h3>
          <a id="id2819390" name="id2819390"></a>D-BUS Dependencies
        </h3>
        <h4>
          <a id="id2837625" name="id2837625"></a>Optional
        </h4>
        <p class="optional">
          <a href="pkgconfig.html">pkg-config-0.20</a>, <a href=
          "expat.html">expat-2.0.0</a> or <a href=
          "libxml2.html">libxml2-2.6.26</a>, <a href=
          "glib2.html">GLib-2.10.3</a>, <a href=
          "../x/gtk2.html">GTK+-2.8.20</a>, <a href=
          "../x/lib.html#qt">Qt-3.3.7</a>, <a href=
          "http://www.trolltech.com/products/qt"><span class=
          "url">Qt-4.x.x</span></a>, <a href="../x/installing.html">X Window
          System</a>, <a href="gcc.html">GCC-4.0.3</a> (for the Java compiler
          and tools), <a href=
          "http://nz.cosc.canterbury.ac.nz/~greg/python/Pyrex/"><span class=
          "url">Pyrex</span></a> (<a href=
          "ftp://ftp.fu-berlin.de/unix/linux/mirrors/gentoo/distfiles/Pyrex-0.9.4.1.tar.gz"><span class="url">version
          0.9.4.1</span></a> is known to work and requires <a href=
          "python.html">Python-2.4.4</a>), <a href=
          "http://www.mono-project.com/GtkSharp"><span class=
          "url">GtkSharp-1.0.x</span></a> (requires <a href=
          "http://go-mono.org"><span class="url">Mono</span></a>), <a href=
          "http://go-mono.com/sources-stable/"><span class=
          "url">Monodoc</span></a>, <a href="doxygen.html">Doxygen-1.4.6</a>
          (to generate the API documentation), and <a href=
          "http://cyberelk.net/tim/xmlto/"><span class="url">xmlto</span></a>
          (to generate HTML documentation and manuals)
        </p>
        <p>
          Listed below are some additional notes about the dependencies
        </p>
        <div class="itemizedlist">
          <ul compact="compact">
            <li>
              <p>
                Review the information from running <span><strong class=
                "command">./configure --help</strong></span> for the
                available parameters to pass to the <span><strong class=
                "command">configure</strong></span> script to enable the
                various dependencies.
              </p>
            </li>
            <li>
              <p>
                To build the <span class="application">Mono</span> bindings,
                you must have <span class="application">GtkSharp</span>
                installed. If you wish to use recent versions of <span class=
                "application">GtkSharp</span>, you'll need to make some
                trivial patches to the <span class="application">D-BUS</span>
                sources. See <a href=
                "http://www.mono-project.com/GtkSharpUpgrade"><span class=
                "url">http://www.mono-project.com/GtkSharpUpgrade</span></a>
                for details.
              </p>
            </li>
            <li>
              <p>
                If you have a recent version of <a href=
                "http://go-mono.com/sources-stable/"><span class=
                "url">Monodoc</span></a> installed (&gt;= 1.1.10) and you
                passed the <tt class="option">--enable-mono-docs</tt>
                parameter to <span><strong class=
                "command">configure</strong></span>, the <span class=
                "application">D-BUS</span> build will fail. You can review
                the parts of this patch (<a href=
                "http://www.mail-archive.com/frugalware-darcs@frugalware.org/msg10156.html"><span class="url">http://www.mail-archive.com/frugalware-darcs@frugalware.org/msg10156.html</span></a>)
                that apply to the <span class="application">Monodoc</span>
                installation, to fix the build problems. Note this is
                untested by the BLFS Team, but should work just fine.
              </p>
            </li>
          </ul>
        </div>
        <h4>
          <a id="hal-requirements" name="hal-requirements"></a>HAL
          Requirements
        </h4>
        <p>
          <a href="glib2.html">GLib-2.10.3</a> must be installed before you
          begin building <span class="application">D-BUS</span> if you plan
          on installing <a href="hal.html">HAL-0.5.7.1</a>. <span class=
          "application">GLib</span> is required to build the <tt class=
          "filename">libdbus-glib</tt> library, which is required by the
          <span class="application">HAL</span> daemon.
        </p>
        <p>
          If you plan on using <span class="application">HAL</span> with
          <span class="application">KDE</span>, you'll need to link
          <span class="application">D-BUS</span> with the <span class=
          "application">Qt</span> libraries. Ensure you've installed
          <span class="application">Qt</span> before beginning the
          <span class="application">D-BUS</span> installation.
        </p>
        <p>
          If you desire to use the <a href=
          "hal.html#hal-device-manager"><span><strong class=
          "command">hal-device-manager</strong></span></a> program, <a href=
          "http://nz.cosc.canterbury.ac.nz/~greg/python/Pyrex/"><span class=
          "url">Pyrex</span></a> (note the known working version listed in
          the dependencies) must be installed before you begin building
          <span class="application">D-BUS</span> as the <span class=
          "application">D-BUS</span> <span class="application">Python</span>
          bindings are required. You will also need to remove the <em class=
          "parameter"><tt>--disable-python</tt></em> parameter from the
          <span><strong class="command">configure</strong></span> command in
          the instructions below.
        </p>
        <p class="usernotes">
          User Notes: <a href=
          "http://wiki.linuxfromscratch.org/blfs/wiki/dbus"><span class=
          "url">http://wiki.linuxfromscratch.org/blfs/wiki/dbus</span></a>
        </p>
      </div>
      <div class="kernel" lang="en" xml:lang="en">
        <div class="titlepage">
          <a id="dbus-kernel" name="dbus-kernel"></a>
          <h2 class="sect2">
            Kernel Configuration
          </h2>
        </div>
        <p>
          Ensure the following option is enabled in the kernel configuration
          and recompile the kernel if necessary:
        </p>
        <pre class="screen"><tt class="literal">General Setup
  System V IPC</tt></pre>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Installation of D-BUS
          </h2>
        </div>
        <p>
          As the <tt class="systemitem">root</tt> user, create a system user
          and group to handle the system message bus activity:
        </p>
        <pre class="root"><kbd class=
        "command">groupadd -g 18 messagebus &amp;&amp;
useradd -c "D-BUS Message Daemon User" -d /dev/null \
        -u 18 -g messagebus -s /bin/false messagebus</kbd></pre>
        <p>
          Install <span class="application">D-BUS</span> by running the
          following commands (you may wish to review the output from
          <span><strong class="command">./configure --help</strong></span>
          first and add any desired parameters to the <span><strong class=
          "command">configure</strong></span> command shown below):
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr \
            --sysconfdir=/etc \
            --localstatedir=/var \
            --disable-python &amp;&amp;
make</kbd></pre>
        <p>
          The <tt class="option">--enable-doxygen-docs</tt> parameter does
          not work properly. If you have <span class=
          "application">Doxygen</span> installed and you wish to build the
          API documentation, issue <span><strong class=
          "command">doxygen</strong></span>.
        </p>
        <p>
          This package's test suite cannot be run without passing additional
          parameters to <span><strong class=
          "command">configure</strong></span>. These parameters are not
          intended to be used in a production build of <span class=
          "application">D-BUS</span> so you will have to build twice (issuing
          <span><strong class="command">make distclean</strong></span> after
          the first build) if you want to run the regression tests.
        </p>
        <p>
          Now, as the <tt class="systemitem">root</tt> user:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
install -v -m755 -d /usr/share/doc/dbus-0.62 &amp;&amp;
install -v -m644 doc/{TODO,*.{dtd,xml,xsl,html,txt,c}} \
    /usr/share/doc/dbus-0.62</kbd></pre>
        <p>
          If you built the API documentation, install it by issuing the
          following commands as the <tt class="systemitem">root</tt> user:
        </p>
        <pre class="root"><kbd class=
        "command">install -v -m755 -d /usr/share/doc/dbus-0.62/api &amp;&amp;
install -v -m644 doc/api/html/* \
    /usr/share/doc/dbus-0.62/api</kbd></pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Command Explanations
          </h2>
        </div>
        <p>
          <em class="parameter"><tt>--localstatedir=/var</tt></em>: This
          parameter causes the daemon PID file to be created in <tt class=
          "filename">/var/run/dbus</tt> instead of <tt class=
          "filename">/usr/var/run/dbus</tt>.
        </p>
        <p>
          <em class="parameter"><tt>--disable-python</tt></em>: This
          parameter is required if <span class="application">Python</span> is
          not installed. Remove the parameter if <span class=
          "application">Python</span> (and <span class=
          "application">Pyrex</span>) is installed and you wish to build the
          <span class="application">Python</span> bindings.
        </p>
      </div>
      <div class="configuration" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Configuring dbus
          </h2>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title">
                  <a id="dbus-config" name="dbus-config"></a>Config Files
                </h4>
              </div>
            </div>
          </div>
          <p>
            <tt class="filename">/etc/dbus-1/session.conf</tt>, <tt class=
            "filename">/etc/dbus-1/system.conf</tt> and <tt class=
            "filename">/etc/dbus-1/system.d/*</tt>
          </p>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title">
                  <a id="id2599129" name="id2599129"></a>Configuration
                  Information
                </h4>
              </div>
            </div>
          </div>
          <p>
            The configuration files listed above should probably not be
            modified. If changes are required, you should create <tt class=
            "filename">/etc/dbus-1/session-local.conf</tt> and/or <tt class=
            "filename">/etc/dbus-1/system-local.conf</tt> and make any
            desired changes to these files.
          </p>
          <p>
            If any packages install a <span class="application">D-Bus</span>
            <tt class="filename">.service</tt> file outside of the standard
            <tt class="filename">/usr/share/dbus-1/services</tt> directory,
            that directory should be added to the local session
            configuration. For instance, <tt class=
            "filename">/usr/local/share/dbus-1/services</tt> can be added by
            performing the following commands as the <tt class=
            "systemitem">root</tt> user:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/dbus-1/session-local.conf &lt;&lt; "EOF"
<tt class="literal">&lt;!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd"&gt;
&lt;busconfig&gt;

  &lt;!-- Search for .service files in /usr/local --&gt;
  &lt;servicedir&gt;/usr/local/share/dbus-1/services&lt;/servicedir&gt;

&lt;/busconfig&gt;</tt>
EOF</kbd></pre>
        </div>
        <div class="sect3" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title">
                  <a id="dbus-init" name="dbus-init"></a>Boot Script
                </h4>
              </div>
            </div>
          </div>
          <p>
            To automatically start <span><strong class=
            "command">dbus-daemon</strong></span> when the system is
            rebooted, install the <tt class=
            "filename">/etc/rc.d/init.d/dbus</tt> bootscript from the
            <a href="../introduction/bootscripts.html">blfs-bootscripts-20060910</a>
            package.
          </p>
          <pre class="root"><kbd class=
          "command">make install-dbus</kbd></pre>
          <p>
            Note that this boot script only starts the system-wide
            <span class="application">D-BUS</span> daemon. Each user
            requiring access to <span class="application">D-BUS</span>
            services will also need to run a session daemon as well. There
            are many methods you can use to start a session daemon using the
            <span><strong class="command">dbus-launch</strong></span>
            command. Review the <span><strong class=
            "command">dbus-launch</strong></span> man page for details about
            the available parameters and options. Here are some suggestions
            and examples:
          </p>
          <div class="itemizedlist">
            <ul compact="compact">
              <li>
                <p>
                  Add <span><strong class=
                  "command">dbus-launch</strong></span> to the line in the
                  <tt class="filename">~/.xinitrc</tt> file that starts your
                  graphical desktop environment as shown in <a href=
                  "../gnome/config.html" title=
                  "Configuring the Core GNOME Packages">the section called
                  &ldquo;Configuring the Core GNOME Packages&rdquo;</a>.
                </p>
              </li>
              <li>
                <p>
                  If you use <span><strong class=
                  "command">xdm</strong></span> or some other display manager
                  that calls the <tt class="filename">~/.xsession</tt> file,
                  you can add <span><strong class=
                  "command">dbus-launch</strong></span> to the line in your
                  <tt class="filename">~/.xsession</tt> file that starts your
                  graphical desktop environment. The syntax would be similar
                  to the example in the <tt class="filename">~/.xinitrc</tt>
                  file.
                </p>
              </li>
              <li>
                <p>
                  If you use <span><strong class=
                  "command">gdm</strong></span> or some other display manager
                  that utilizes custom files to initiate sessions, use the
                  example in <a href="../gnome/gdm.html#gdm-config-dbus">the
                  section called &ldquo;Configuration Information&rdquo;</a>
                  of the <span class="application">GDM</span> instructions to
                  create a file containing <span><strong class=
                  "command">dbus-launch</strong></span>.
                </p>
              </li>
              <li>
                <p>
                  The examples shown previously use <span><strong class=
                  "command">dbus-launch</strong></span> to specify a program
                  to be run. This has the benefit (when also using the
                  <em class="parameter"><tt>--exit-with-session</tt></em>
                  parameter) of stopping the session daemon when the
                  specified program is stopped. You can also start the
                  session daemon in your system or personal startup scripts
                  by adding the following lines:
                </p>
                <pre class="userinput"><kbd class="command"><tt class=
                "literal"># Start the D-BUS session daemon
eval `dbus-launch`
export DBUS_SESSION_BUS_ADDRESS</tt></kbd></pre>
                <p>
                  This method will not stop the session daemon when you exit
                  your shell, therefore you should add the following line to
                  your <tt class="filename">~/.bash_logout</tt> file:
                </p>
                <pre class="userinput"><kbd class="command"><tt class=
                "literal"># Kill the D-BUS session daemon
kill $DBUS_SESSION_BUS_PID</tt></kbd></pre>
              </li>
              <li>
                <p>
                  A hint has been written that provides ways to start scripts
                  using the KDM session manager of KDE. The concepts in this
                  hint could possibly used with other session managers as
                  well. The hint is located at <a href=
                  "http://www.linuxfromscratch.org/hints/downloads/files/execute-session-scripts-using-kdm.txt">
                  <span class=
                  "url">http://www.linuxfromscratch.org/hints/downloads/files/execute-session-scripts-using-kdm.txt</span></a>.
                </p>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            Contents
          </h2>
        </div>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong><span class="segtitle">Installed
              Programs:</span></strong> <span class="seg">dbus-binding-tool,
              dbus-cleanup-sockets, dbus-daemon, dbus-launch, dbus-monitor,
              dbus-send and dbus-viewer</span>
            </div>
            <div class="seg">
              <strong><span class="segtitle">Installed
              Libraries:</span></strong> <span class="seg">libdbus-1.{so,a}
              and optionally, dbus-1.jar, libdbus-gcj-1.{so,a},
              libdbus-glib-1.{so,a}, libdbus-qt-1.{so,a},
              libdbus-qt4-1.{so,a}, libdbus-mono-1.{so,a} and <span class=
              "application">Python</span> modules</span>
            </div>
            <div class="seg">
              <strong><span class="segtitle">Installed
              Directories:</span></strong> <span class="seg">/etc/dbus-1,
              /usr/include/dbus-1.0, /usr/lib/dbus-1.0,
              /usr/lib/python2.4/site-packages/dbus, /usr/share/dbus-1,
              /usr/share/doc/dbus-0.62 and /var/run/dbus</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            <a id="id2553488" name="id2553488"></a>Short Descriptions
          </h3>
          <table border="0">
            <col align="left" valign="top" />
            <tbody>
              <tr>
                <td>
                  <a id="dbus-binding-tool" name=
                  "dbus-binding-tool"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-binding-tool</strong></span></span>
                </td>
                <td>
                  <p>
                    is used to create header files from <span class=
                    "application">GLib</span> object files.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-cleanup-sockets" name=
                  "dbus-cleanup-sockets"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-cleanup-sockets</strong></span></span>
                </td>
                <td>
                  <p>
                    is used to clean up leftover sockets in a directory.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-daemon" name="dbus-daemon"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-daemon</strong></span></span>
                </td>
                <td>
                  <p>
                    is the <span class="application">D-BUS</span> message bus
                    daemon.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-launch" name="dbus-launch"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-launch</strong></span></span>
                </td>
                <td>
                  <p>
                    is used to start <span><strong class=
                    "command">dbus-daemon</strong></span> from a shell
                    script. It would normally be called from a user's login
                    scripts.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-monitor" name="dbus-monitor"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-monitor</strong></span></span>
                </td>
                <td>
                  <p>
                    is used to monitor messages going through a <span class=
                    "application">D-BUS</span> message bus.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-send" name="dbus-send"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-send</strong></span></span>
                </td>
                <td>
                  <p>
                    is used to send a message to a <span class=
                    "application">D-BUS</span> message bus.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="dbus-viewer" name="dbus-viewer"></a><span class=
                  "term"><span><strong class=
                  "command">dbus-viewer</strong></span></span>
                </td>
                <td>
                  <p>
                    is a graphical <span class="application">D-BUS</span>
                    frontend utility.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <a id="libdbus-1" name="libdbus-1"></a><span class=
                  "term"><tt class="filename">libdbus-1.{so,a}</tt></span>
                </td>
                <td>
                  <p>
                    contains the API functions used by the <span class=
                    "application">D-BUS</span> message daemon. <span class=
                    "application">D-BUS</span> is first a library that
                    provides one-to-one communication between any two
                    applications; <span><strong class=
                    "command">dbus-daemon</strong></span> is an application
                    that uses this library to implement a message bus daemon.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on 2007-02-01 13:44:24 -0600
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="apache-ant.html" title=
          "Apache Ant-1.6.5">Prev</a>
          <p>
            Apache Ant-1.6.5
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="hal.html" title="HAL-0.5.7.1">Next</a>
          <p>
            HAL-0.5.7.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapter&nbsp;11.&nbsp;System Utilities">Up</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 6.2.0">Home</a>.
        </li>
      </ul>
    </div>
  </body>
</html>
