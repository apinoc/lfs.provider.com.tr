<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      Chromium-64.0.3282.186
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-8.2">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch - Version 8.2
      </h4>
      <h3>
        Chapter&nbsp;42.&nbsp;Graphical Web Browsers
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="graphweb.html" title=
          "Graphical Web Browsers">Prev</a>
          <p>
            Graphical Web Browsers
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="epiphany.html" title=
          "Epiphany-3.26.6">Next</a>
          <p>
            Epiphany-3.26.6
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="graphweb.html" title=
          "Chapter&nbsp;42.&nbsp;Graphical Web Browsers">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 8.2">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="chromium" name="chromium"></a>Chromium-64.0.3282.186
      </h1>
      <div class="package" lang="en" xml:lang="en">
        <h2 class="sect2">
          Introduction to Chromium
        </h2>
        <p>
          <span class="application">Chromium</span> is an open-source browser
          project that aims to build a safer, faster, and more stable way for
          all users to experience the web.
        </p>
        <p>
          This package is known to build and work properly using an LFS-8.2
          platform.
        </p>
        <h3>
          Package Information
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                Download (HTTP): <a class="ulink" href=
                "https://commondatastorage.googleapis.com/chromium-browser-official/chromium-64.0.3282.186.tar.xz">
                https://commondatastorage.googleapis.com/chromium-browser-official/chromium-64.0.3282.186.tar.xz</a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: 0c361a429c5dcea568cbc7b001a82d92
              </p>
            </li>
            <li>
              <p>
                Download size: 460 MB
              </p>
            </li>
            <li>
              <p>
                Estimated disk space required: 6.0 GB
              </p>
            </li>
            <li>
              <p>
                Estimated build time: 120 SBU (with parallelism=4)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Additional Downloads
        </h3>
        <h4>
          Required patch:
        </h4>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                <a class="ulink" href=
                "http://www.linuxfromscratch.org/patches/blfs/8.2/chromium-64.0.3282.186-constexpr-1.patch">
                http://www.linuxfromscratch.org/patches/blfs/8.2/chromium-64.0.3282.186-constexpr-1.patch</a>
              </p>
            </li>
          </ul>
        </div>
        <h4>
          Optional Chrome binaries to extract the <span class=
          "application">WideVine</span> plug-in (Netflix) support:
        </h4>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                Download (HTTP): <a class="ulink" href=
                "http://dl.google.com/linux/chrome/deb/pool/main/g/google-chrome-stable/google-chrome-stable_64.0.3282.186-1_amd64.deb">
                http://dl.google.com/linux/chrome/deb/pool/main/g/google-chrome-stable/google-chrome-stable_64.0.3282.186-1_amd64.deb</a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: 1caee436e3dc8fda6560a421e60717e4
              </p>
            </li>
            <li>
              <p>
                Download size: 49.1 MB
              </p>
            </li>
          </ul>
        </div>
        <div class="itemizedlist">
          <ul class="compact">
            <li>
              <p>
                Download (HTTP): <a class="ulink" href=
                "http://mirror.retrosnub.co.uk/apt/google/pool/main/g/google-chrome-stable/google-chrome-stable_48.0.2564.116-1_i386.deb">
                http://mirror.retrosnub.co.uk/apt/google/pool/main/g/google-chrome-stable/google-chrome-stable_48.0.2564.116-1_i386.deb</a>
              </p>
            </li>
            <li>
              <p>
                Download MD5 sum: 895e877b9bfe5da05a061369c2078626
              </p>
            </li>
            <li>
              <p>
                Download size: 45.3 MB
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Chromium Dependencies
        </h3>
        <h4>
          Required
        </h4>
        <p class="required">
          <a class="xref" href="../multimedia/alsa-lib.html" title=
          "alsa-lib-1.1.5">alsa-lib-1.1.5</a>, <a class="xref" href=
          "../pst/cups.html" title="Cups-2.2.6">Cups-2.2.6</a>, <a class=
          "xref" href="../general/desktop-file-utils.html" title=
          "desktop-file-utils-0.23">desktop-file-utils-0.23</a>, <a class=
          "xref" href="../general/dbus.html" title=
          "dbus-1.12.4">dbus-1.12.4</a>, <a class="xref" href=
          "../general/perl-modules.html#perl-file-basedir" title=
          "File::BaseDir-0.07">File::BaseDir-0.07</a>, <a class="xref" href=
          "../x/gtk3.html" title="GTK+-3.22.28">GTK+-3.22.28</a>, <a class=
          "xref" href="../x/hicolor-icon-theme.html" title=
          "hicolor-icon-theme-0.17">hicolor-icon-theme-0.17</a>, <a class=
          "xref" href="../postlfs/mitkrb.html" title=
          "MIT Kerberos V5-1.16">MIT Kerberos V5-1.16</a>, <a class="xref"
          href="../x/mesa.html" title="Mesa-17.3.4">Mesa-17.3.4</a>,
          <a class="xref" href="../general/nodejs.html" title=
          "Node.js-9.5.0">nodejs-9.5.0</a>, <a class="xref" href=
          "../postlfs/nss.html" title="NSS-3.35">NSS-3.35</a>, <a class=
          "xref" href="../general/python2.html" title=
          "Python-2.7.14">Python-2.7.14</a>, <a class="xref" href=
          "../general/usbutils.html" title="usbutils-009">usbutils-009</a>,
          and <a class="xref" href="../x/installing.html" title=
          "Chapter&nbsp;24.&nbsp;X Window System Environment">X Window
          System</a>
        </p>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="../postlfs/make-ca.html" title=
          "make-ca-0.7">make-ca-0.7</a> (runtime), <a class="xref" href=
          "../multimedia/flac.html" title="FLAC-1.3.2">FLAC-1.3.2</a>,
          <a class="xref" href="../general/git.html" title=
          "Git-2.16.2">git-2.16.2</a>, <a class="xref" href=
          "../x/TTF-and-OTF-fonts.html#liberation-fonts" title=
          "Liberation fonts">Liberation fonts</a> <a class="xref" href=
          "../general/libexif.html" title=
          "libexif-0.6.21">libexif-0.6.21</a>, <a class="xref" href=
          "../general/libjpeg.html" title=
          "libjpeg-turbo-1.5.3">libjpeg-turbo-1.5.3</a>, <a class="xref"
          href="../gnome/libsecret.html" title=
          "libsecret-0.18.5">libsecret-0.18.5</a>, <a class="xref" href=
          "../general/libwebp.html" title="libwebp-0.6.1">libwebp-0.6.1</a>,
          <a class="xref" href="../general/pciutils.html" title=
          "pciutils-3.5.6">pciutils-3.5.6</a>, <a class="xref" href=
          "../multimedia/pulseaudio.html" title=
          "PulseAudio-11.1">PulseAudio-11.1</a>, <a class="xref" href=
          "xdg-utils.html" title="xdg-utils-1.1.2">xdg-utils-1.1.2</a>, and
          <a class="xref" href="../general/yasm.html" title=
          "yasm-1.3.0">yasm-1.3.0</a>
        </p>
        <h4>
          Optional
        </h4>
        <p class="optional">
          <a class="xref" href="../multimedia/ffmpeg.html" title=
          "FFmpeg-3.4.2">FFmpeg-3.4.2</a> (currently broken), <a class="xref"
          href="../gnome/GConf.html" title="GConf-3.2.6">GConf-3.2.6</a>,
          <a class="xref" href="../general/icu.html" title=
          "ICU-60.2">ICU-60.2</a> (currently broken), <a class="xref" href=
          "../gnome/gnome-keyring.html" title=
          "gnome-keyring-3.20.1">gnome-keyring-3.20.1</a>, <a class="xref"
          href="../basicnet/libevent.html" title=
          "libevent-2.1.8">libevent-2.1.8</a>, <a class="xref" href=
          "../general/libpng.html" title="libpng-1.6.34">libpng-1.6.34</a>
          (currently broken), <a class="xref" href=
          "../multimedia/libvpx.html" title="libvpx-1.7.0">libvpx-1.7.0</a>
          (currently broken), <a class="xref" href="../general/libxml2.html"
          title="libxml2-2.9.7">libxml2-2.9.7</a> (currently broken),
          <a class="xref" href="../general/upower.html" title=
          "UPower-0.99.7">UPower-0.99.7</a> (runtime), <a class="ulink" href=
          "https://devel.freebsoft.org/speechd">speech-dispatcher</a> (for
          the screen reader), and <a class="ulink" href=
          "https://google.github.io/snappy">snappy</a>
        </p>
        <p class="usernotes">
          User Notes: <a class="ulink" href=
          "http://wiki.linuxfromscratch.org/blfs/wiki/chromium">http://wiki.linuxfromscratch.org/blfs/wiki/chromium</a>
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          Installation of Chromium
        </h2>
        <p>
          Enable the use of the <a class="ulink" href=
          "http://www.widevine.com/">WideVine</a> plugin, needed for Netflix
          support (see the WideVine section below). Define an available
          product name ("Pinkie Pie" in this case) with the following
          command:
        </p>
        <pre class="userinput">
<kbd class="command">line='#define WIDEVINE_CDM_VERSION_STRING "Pinkie Pie"' 
sed "/WIDEVINE_CDM_AVAILABLE/a$line" \
    -i third_party/widevine/cdm/stub/widevine_cdm_version.h</kbd>
</pre>
        <p>
          Optionally silence several (2000+) invalid warnings:
        </p>
        <pre class="userinput">
<kbd class="command">sed '/static_assert/s:^://:' \
    -i third_party/WebKit/Source/platform/wtf/text/TextCodec.h</kbd>
</pre>
        <p>
          Fix a build issue with recent versions of GCC:
        </p>
        <pre class="userinput">
<kbd class=
"command">patch -Np1 -i ../chromium-64.0.3282.186-constexpr-1.patch</kbd>
</pre>
        <p>
          Remove third-party build files that interfere with system versions:
        </p>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Chromium uses many external projects, the selections below are
            not set in stone, however they have been tested thoroughly. With
            Chromium 64.0.3282.186, system versions of libvpx, libxml2, and
            zlib are known to break the build at this time.
          </p>
        </div>
        <pre class="userinput">
<kbd class="command">for LIB in flac freetype harfbuzz-ng libjpeg \
           libjpeg_turbo libwebp libxslt yasm; do
    find -type f -path "*third_party/$LIB/*"      \
        \! -path "*third_party/$LIB/chromium/*"   \
        \! -path "*third_party/$LIB/google/*"     \
        \! -path "*base/third_party/icu/*"        \
        \! -path './third_party/yasm/run_yasm.py' \
        \! -regex '.*\.\(gn\|gni\|isolate\|py\)'  \
        \! -path './third_party/freetype/src/src/psnames/pstables.h' \
        -delete
done &amp;&amp;

python build/linux/unbundle/replace_gn_files.py     \
    --system-libraries flac libjpeg libxml libevent \
                       libwebp libxslt opus yasm     &amp;&amp;

python third_party/libaddressinput/chromium/tools/update-strings.py</kbd>
</pre>
        <p>
          <span class="application">Chromium</span> uses an internal tool,
          <a class="ulink" href=
          "https://chromium.googlesource.com/chromium/src/tools/gn">gn</a>,
          to generate the <span class="application">Ninja</span> build files.
          Complete configuration of the build using the following commands:
        </p>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            The Google API Key and OAuth tokens below are specific to LFS. If
            using these instructions for another distro, or if you intend to
            distribute binary copies of the software using these
            instructions, please obtain your own keys following the
            instructions located at <a class="ulink" href=
            "http://www.chromium.org/developers/how-tos/api-keys">http://www.chromium.org/developers/how-tos/api-keys</a>.
          </p>
        </div>
        <pre class="userinput">
<kbd class=
"command">GN_CONFIG=('google_api_key="AIzaSyDxKL42zsPjbke5O8_rPVpVrLrJ8aeE9rQ"'
'google_default_client_id="595013732528-llk8trb03f0ldpqq6nprjp1s79596646.apps.googleusercontent.com"'
'google_default_client_secret="5ntt6GbbkjnTVXx-MSxbmx5e"'
'clang_use_chrome_plugins=false'
'enable_hangout_services_extension=true'
'enable_nacl=false'
'enable_nacl_nonsfi=false'
'enable_swiftshader=false'
'enable_widevine=true'
'fatal_linker_warnings=false'
'ffmpeg_branding="Chrome"'
'fieldtrial_testing_like_official_build=true'
'is_debug=false'
'is_clang=false'
'link_pulseaudio=true'
'linux_use_bundled_binutils=false'
'proprietary_codecs=true'
'remove_webcore_debug_symbols=true'
'symbol_level=0'
'treat_warnings_as_errors=false'
'use_allocator="none"'
'use_cups=true'
'use_gconf=false'
'use_gnome_keyring=false'
'use_gold=false'
'use_gtk3=true'
'use_kerberos=true'
'use_pulseaudio=true'
'use_sysroot=false'
'use_system_freetype=true'
'use_system_harfbuzz=true')</kbd>
</pre>
        <p>
          Build <span class="application">gn</span> and use it to prepare the
          <span class="application">Ninja</span> build files:
        </p>
        <pre class="userinput">
<kbd class=
"command">python tools/gn/bootstrap/bootstrap.py --gn-gen-args "${GN_CONFIG[*]}" &amp;&amp;
out/Release/gn gen out/Release --args="${GN_CONFIG[*]}"</kbd>
</pre>
        <div class="admon warning">
          <img alt="[Warning]" src="../images/warning.png" />
          <h3>
            Warning
          </h3>
          <p>
            Ninja, by default, sets the number of jobs to the number of
            available threads. If your machine is memory constrained, with
            regard to number of threads, you should reduce the number of jobs
            by passing the <em class="parameter"><code>-j#</code></em> switch
            to the <span class="command"><strong>ninja</strong></span>
            command below. Plan for roughly 1.25GB per thread while linking
            <span class="application">WebKit</span> to avoid out of memory
            errors.
          </p>
        </div>
        <p>
          Build <span class="application">Chromium</span> using the following
          commands:
        </p>
        <pre class="userinput">
<kbd class=
"command">mkdir -p third_party/node/linux/node-linux-x64/bin &amp;&amp;
ln -s /usr/bin/node third_party/node/linux/node-linux-x64/bin/ &amp;&amp;
ninja -C out/Release chrome chrome_sandbox chromedriver widevinecdmadapter</kbd>
</pre>
        <p>
          This package was already tested as part of the build.
        </p>
        <p>
          Now, as the <code class="systemitem">root</code> user, install the
          package:
        </p>
        <pre class="root">
<kbd class="command">install -vDm755  out/Release/chrome \
                 /usr/lib/chromium/chromium                   &amp;&amp;

install -vDm4755 out/Release/chrome_sandbox \
                 /usr/lib/chromium/chrome-sandbox             &amp;&amp;

install -vDm755  out/Release/chromedriver \
                 /usr/lib/chromium/chromedriver               &amp;&amp;

ln -svf /usr/lib/chromium/chromium     /usr/bin               &amp;&amp;
ln -svf /usr/lib/chromium/chromedriver /usr/bin               &amp;&amp;

install -vDm644 out/Release/gen/content/content_resources.pak \
                /usr/lib/chromium/                            &amp;&amp;

install -vDm644 out/Release/icudtl.dat \
                /usr/lib/chromium/icudtl.dat                  &amp;&amp;

install -vDm644 out/Release/{*.pak,*.bin} \
                /usr/lib/chromium/                            &amp;&amp;

sed -i \
    -e "s/@@MENUNAME@@/Chromium/g" \
    -e "s/@@PACKAGE@@/chromium/g" \
    -e "s/@@USR_BIN_SYMLINK_NAME@@/chromium/g" \
    chrome/installer/linux/common/desktop.template \
    chrome/app/resources/manpage.1.in                         &amp;&amp;

install -vDm644 chrome/installer/linux/common/desktop.template \
                /usr/share/applications/chromium.desktop      &amp;&amp;

install -vDm644 chrome/app/resources/manpage.1.in \
                /usr/share/man/man1/chromium.1                &amp;&amp;

cp -av out/Release/locales /usr/lib/chromium/                 &amp;&amp;
chown -Rv root:root /usr/lib/chromium/locales                 &amp;&amp;

for size in 16 32; do
    install -vDm644 \
        "chrome/app/theme/default_100_percent/chromium/product_logo_$size.png" \
        "/usr/share/icons/hicolor/${size}x${size}/apps/chromium.png"
done &amp;&amp;

for size in 22 24 48 64 128 256; do
    install -vDm644 "chrome/app/theme/chromium/product_logo_$size.png" \
        "/usr/share/icons/hicolor/${size}x${size}/apps/chromium.png"
done</kbd>
</pre>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            If upgrading from a previous build of chromium using gtk+-2.x,
            you may need to remove the <code class=
            "filename">~/.config/chromium</code> directory.
          </p>
        </div>
        <h3>
          Extracting the WideVine plugin from Chrome
        </h3>
        <p>
          Extract the downloaded deb file with the following commands:
        </p>
        <pre class="userinput">
<kbd class=
"command">mkdir temp                                         &amp;&amp;
cd temp                                            &amp;&amp;
case $(uname -m) in
    x86_64) ar -x ../../google-chrome-stable_64.0.3282.186-1_amd64.deb
    ;;
    i?86)   ar -x ../../google-chrome-stable_48.0.2564.116-1_i386.deb
    ;;
esac</kbd>
</pre>
        <p>
          As the <code class="systemitem">root</code> user, enable the
          WideVine plugin with the following commands:
        </p>
        <pre class="root">
<kbd class=
"command">tar -xf data.tar.xz                                                        &amp;&amp;
install -vm755 ../out/Release/libwidevinecdmadapter.so /usr/lib/chromium/  &amp;&amp;
install -vm755 opt/google/chrome/libwidevinecdm.so  /usr/lib/chromium/</kbd>
</pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <h2 class="sect2">
          Command Explanations
        </h2>
        <p>
          <span class="command"><strong>GN_CONFIG=(...)</strong></span>: this
          array contains all of the defines used in the build.
        </p>
        <p>
          <span class="command"><strong>python
          tools/gn/bootstrap/bootstrap.py --gn-gen-args
          "${GN_CONFIG[*]}"</strong></span>: this command replaces defines in
          the gn files with the values contained in <code class=
          "envar">${GN_CONFIG[@]}</code>.
        </p>
        <p>
          <span class="command"><strong>out/Release/gn gen out/Release
          --args="${GN_CONFIG[*]}"</strong></span>: this command runs a
          Google provided configuration script <span class=
          "application">gn</span> on the source tree to produce a
          <span class="application">Ninja</span> configuration suitable for
          the build machine.
        </p>
        <p>
          <span class="command"><strong>mkdir...ln -s /usr/bin/node
          third_party/node/linux/node-linux-x64/bin/</strong></span>: these
          commands replaced the local <span class=
          "application">Node.js</span> (no longer available) with the system
          installed <span class="application">Node.js</span>.
        </p>
        <p>
          <span class="command"><strong>ar -x
          ../../google-chrome-stable*.deb</strong></span>: the <span class=
          "command"><strong>ar</strong></span> utility is used to extract
          Debian archives.
        </p>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed Programs:</strong>
              <span class="segbody">/usr/lib/chromium/chromium,
              /usr/lib/chromium/chromedriver, and
              /usr/lib/chromium/chrome-sandbox</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Libraries:</strong>
              <span class="segbody">none</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Directories:</strong>
              <span class="segbody">/usr/lib/chromium</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0">
            <col align="left" valign="top" />
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="chromium-lib" name="chromium-lib"></a><span class=
                    "term"><span class=
                    "command"><strong>/usr/lib/chromium/chromium</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the main chromium executable.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="chromedriver" name="chromedriver"></a><span class=
                    "term"><span class=
                    "command"><strong>/usr/lib/chromium/chromedriver</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a <a class="ulink" href=
                    "http://www.seleniumhq.org/projects/webdriver/">WebDriver</a>
                    for Chromium.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="chrome-sandbox" name=
                    "chrome-sandbox"></a><span class="term"><span class=
                    "command"><strong>/usr/lib/chromium/chrome-sandbox</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    creates a sandboxed environment for running untrusted
                    code (plugins).
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on 2018-03-02 17:58:04 -0800
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="graphweb.html" title=
          "Graphical Web Browsers">Prev</a>
          <p>
            Graphical Web Browsers
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="epiphany.html" title=
          "Epiphany-3.26.6">Next</a>
          <p>
            Epiphany-3.26.6
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="graphweb.html" title=
          "Chapter&nbsp;42.&nbsp;Graphical Web Browsers">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch - Version 8.2">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
